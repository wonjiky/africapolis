{"version":3,"file":"Viz.js","sources":["../../src/Viz.js"],"sourcesContent":["import React, {Component} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport {assign} from \"d3plus-common\";\n\n/**\n    @class Viz\n    @extends React.Component\n    @desc Creates SVG paths and coordinate points based on an array of data. See [this example](https://d3plus.org/examples/d3plus-geomap/getting-started/) for help getting started using the geomap generator.\n*/\nclass Viz extends Component {\n\n  /**\n      @memberof Viz\n      @desc Initializes the specific visualization's class instance and binds it to the container <div>.\n      @private\n  */\n  componentDidMount() {\n    const {type: Constructor} = this.props;\n\n    this.viz = new Constructor().select(this.container);\n    this.renderViz.bind(this)();\n\n  }\n\n  /**\n      @memberof Viz\n      @desc Updates visualization config on component update.\n      @private\n  */\n  componentDidUpdate(prevProps) {\n\n    const globalConfig = this.context.d3plus || {};\n    const {config, forceUpdate} = this.props;\n    const c = assign({}, globalConfig, config);\n    const c2 = assign({}, globalConfig, prevProps.config);\n\n    const same = forceUpdate ? false : JSON.stringify(c) === JSON.stringify(c2);\n    if (!same) this.renderViz.bind(this)();\n\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets visualization config, accounting for dataFormat, and renders the visualization.\n      @private\n  */\n  renderViz() {\n    const {viz} = this;\n    const {config, dataFormat} = this.props;\n    const globalConfig = this.context.d3plus || {};\n    const c = assign({}, globalConfig, config);\n\n    if (dataFormat && c.data) viz.config(c).data(c.data, dataFormat);\n    else viz.config(c);\n    viz.render();\n\n  }\n\n  /**\n      @memberof Viz\n      @desc Renders an empty container to hold the visualization.\n      @private\n  */\n  render() {\n    const {className} = this.props;\n    return <div className={className} ref={container => this.container = container}></div>;\n  }\n\n}\n\nViz.contextTypes = {d3plus: PropTypes.object};\nViz.defaultProps = {\n  className: \"viz\",\n  forceUpdate: false\n};\n\n/**\n    @memberof Viz\n    @param {Object} [config = {}] An object containing method/value pairs to be passed to the visualization's .config( ) method.\n    @param {Function} [dataFormat = d3plus.dataFold] A custom formatting function to be used when formatting data from an AJAX request. The function will be passed the raw data returned from the request, and is expected to return an array of values used for the data method.\n*/\nexport default Viz;\n"],"names":["const","this"],"mappings":"AAAA,OAAO,KAAK,GAAG,SAAS,OAAO,OAAO,CAAC;AACvC,OAAO,SAAS,MAAM,YAAY,CAAC;;AAEnC,QAAQ,MAAM,OAAO,eAAe,CAAC;;;;;;;AAOrC,IAAM,GAAG,GAAkB;;;;;;;;;gBAOzB,+CAAiB,GAAG;IAClB,OAAyB,GAAG,IAAI,CAAC;IAApB,2BAA0B;;IAEvC,IAAI,CAAC,GAAG,GAAG,IAAI,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACpD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;;IAE7B;;;;;;;gBAOD,iDAAkB,CAAC,SAAS,EAAE;;IAE5BA,GAAK,CAAC,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC;IAC/C,OAA2B,GAAG,IAAI,CAAC;IAA5B;IAAQ,kCAA0B;IACzCA,GAAK,CAAC,CAAC,GAAG,MAAM,CAAC,EAAE,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;IAC3CA,GAAK,CAAC,EAAE,GAAG,MAAM,CAAC,EAAE,EAAE,YAAY,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;;IAEtDA,GAAK,CAAC,IAAI,GAAG,WAAW,GAAG,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;IAC5E,IAAI,CAAC,IAAI,IAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,GAAC;;IAExC;;;;;;;gBAOD,+BAAS,GAAG;IACV,OAAW,GAAG;IAAP,kBAAY;IACnB,SAA0B,GAAG,IAAI,CAAC;IAA3B;IAAQ,kCAAyB;IACxCA,GAAK,CAAC,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC;IAC/CA,GAAK,CAAC,CAAC,GAAG,MAAM,CAAC,EAAE,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;;IAE3C,IAAI,UAAU,IAAI,CAAC,CAAC,IAAI,IAAE,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,UAAU,CAAC,GAAC;WAC5D,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,GAAC;IACnB,GAAG,CAAC,MAAM,EAAE,CAAC;;IAEd;;;;;;;gBAOD,yBAAM,GAAG;;AAAC;IACR,OAAiB,GAAG,IAAI,CAAC;IAAlB,8BAAwB;IAC/B,OAAO,sBAAC,OAAG,CAAC,WAAW,SAAS,AAAC,EAAC,eAAK,UAAS,CAAC,SAAGC,MAAI,CAAC,SAAS,GAAG,SAAS,KAAE,CAAM,CAAC;GACxF;;;EAzDe,YA2DjB;;AAED,GAAG,CAAC,YAAY,GAAG,CAAC,MAAM,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;AAC9C,GAAG,CAAC,YAAY,GAAG;EACjB,SAAS,EAAE,KAAK;EAChB,WAAW,EAAE,KAAK;CACnB,CAAC;;;;;;;AAOF,eAAe,GAAG,CAAC;"}